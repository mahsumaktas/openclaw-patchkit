# OpenClaw PR patch list
# Format: PR_NUMBER | SHORT_DESCRIPTION
# Lines starting with # are comments
# Remove a line when the PR gets merged upstream
#
# Last updated: 2026-02-24
# Base version: v2026.2.22
# Total: 90 patches (12 wave-1 + 12 wave-2 + 28 wave-3 + 38 wave-4) — 2 closed, 2 removed

# ── Wave 1: Original patches (2026-02-24) ───────────────────────────────────
24614 | fix: models.list allowlist respect
24733 | fix: normalize peer.kind in resolveAgentRoute
24695 | fix(process): pid kill after group kill
24672 | fix(plugins): before_compaction hook session context
24727 | fix(memory): qmd busy_timeout contention
# 24758 | REMOVED: v2026.2.22 incompatible (PR grew too large)
24538 | fix(discord): replyToMode first/off delivery
24500 | fix(telegram): streaming preview on error payload
24039 | fix(logging): local time in console timestamps
24559 | fix: persist reasoningLevel 'off'
24732 | fix(acp): flush delta text on final chat event
24583 | fix(security): strip external content markers + stripExternalContentFromOutput
24594 | feat(agents): configurable subagent runTimeoutSeconds

# ── Wave 2: Full scan results (2026-02-24) ──────────────────────────────────
# git apply clean:
19129 | fix(config): block destructive config writes
12195 | fix(agents): lookupContextTokens cold-start race
20533 | fix: strip resolvedSkills from session snapshot bloat
21201 | fix(compaction): repair tool_use/tool_result pairing
# git apply --exclude tests:
12760 | fix(memory-flush): fire on every compaction cycle
12254 | fix: minimum token guard prevent double compaction
16992 | fix(gateway): escape XML in filename prevent prompt injection
23557 | fix: catch session JSONL write failures instead of crashing
# manual patch required:
22901 | fix: guard NaN reserveTokens in compaction safeguard
19675 | fix(security): zero-width Unicode boundary marker bypass
16894 | fix: truncation splitting surrogate pairs in subagents/web-fetch
16609 | fix: session store race condition and contextTokens updates

# ── Wave 3: Comprehensive scan (2026-02-24) ──────────────────────────────────
# 2250 PR scored with treliq, 56 selected for rebuild
# git apply clean (15):
16990 | fix(media): strip auth headers on cross-origin redirect
22475 | fix(logging): correct levelToMinLevel mapping to match tslog
24535 | fix: restore template placeholders in HTML session export
22022 | fix: propagate senderIsOwner to agent loop
# 24470 | CLOSED UPSTREAM 2026-02-23 — fix(doctor): replace nonexistent auth add command
20738 | fix: model input schema accept audio/video modalities
19177 | fix: use parseAgentSessionKey instead of fragile split
15603 | fix(gateway): correct malformed HTTP 429 on WebSocket upgrade
22711 | fix: post-compaction audit skips non-existent files
21615 | fix(tui): preserve main session model during heartbeat override
12191 | fix: guard undefined model.input in display and scan
22424 | fix: prevent crash when onUpdate is truthy but not callable
21516 | fix: classify connection errors as timeout for failover
19191 | fix(security): harden cron file permissions to 0o600
12786 | fix: drop duplicate heartbeat runs while another is active
# git apply --exclude tests (5):
11874 | fix: handle fetch rejections in provider usage withTimeout
14005 | fix(memory): bm25RankToScore constant 1.0 for negative ranks
17375 | fix(session): don't carry stale model info into reset welcome
# 13976 | CLOSED UPSTREAM 2026-02-23 — fix(anthropic): include Anthropic in tool call ID sanitization
14328 | fix: strip incomplete tool_use blocks prevent 400 loops
# git apply --exclude changelog (2):
23008 | fix(security): prototype pollution in mergeConfigSection
18193 | fix: default elevatedDefault to 'off' instead of 'on'
# manual patch (10):
17371 | fix(heartbeat): always strip HEARTBEAT_OK token from reply
22900 | fix(discord): set IS_COMPONENTS_V2 flag for v2 components
19134 | fix(gateway): specify utf-8 encoding on SSE res.write()
# 10831 | REMOVED: stale/duplicate of #10536, Opus 4.6 context likely in upstream catalog
16987 | fix(config): skipCache sessionStore prevent lost updates
21847 | fix(session): /new and /reset no longer carry model overrides
17435 | fix(debounce): retry flush with exponential backoff
16015 | fix(gateway): truncate oversized message in chat.history
# 12048 | REMOVED: cosmetic log-noise fix, 182 additions not worth patch maintenance
17823 | fix: memory leak in cron isolated runs Maps cleanup

# ── Wave 4: Sonnet 4.6 full scan (2026-02-24) ────────────────────────────────
# 4051 PRs scored with Sonnet 4.6, 38 new patches selected
# git apply clean (27):
24795 | fix(ui): load saved locale translations on startup
24764 | fix(failover): classify subscription/plan unavailability as billing
24761 | fix(auth): classify OAuth missing-scope errors as auth
24516 | fix(cli): load plugin registry for configure and onboard commands
22025 | fix(telegram): accept colon provider ids in mdl_list callbacks
20990 | fix: handle single-element type arrays in tryFlattenLiteralAnyOf
16963 | fix: enable auth rate limiting by default
24181 | fix(discord): pass gateway auth token to exec approval handler
22929 | fix: NODE_EXTRA_CA_CERTS missing from LaunchAgent on macOS
19406 | fix(heartbeat): filter error payloads from heartbeat reply selection
10807 | fix(config): coerce numeric meta.lastTouchedAt to ISO string
24763 | fix(gateway): include pairing requestId in close reason and recovery hints
20867 | fix: allow video and audio in models.input config
14023 | fix: filter skills watcher to relevant file types prevent FD exhaustion
24571 | fix(security): prevent cross-channel reply routing in shared sessions
24164 | fix(status): label codex 7-day usage window as Week
13288 | fix(cron): normalize string schedule/payload from non-frontier LLMs
24805 | fix(usage): include archived deleted transcripts in usage-cost totals
24501 | fix(cli): keep update status --json machine-readable
24379 | fix(config): preserve env var refs during gateway startup config writes
23071 | fix(tts): make config auto=off hard-disable overrides user prefs
13626 | fix(model): propagate provider model properties in fallback resolution
13849 | fix(configure): preserve custom config keys across wizard sections
12665 | fix(tools): recognise tool groups expanding to plugin tools in allowlist
13104 | fix: persist user command message in chat transcript
12475 | fix(logging): Symbol.for externalTransports survive jiti module isolation
11613 | fix: clear stale model metadata on /new and /reset
# git apply --exclude tests (6):
21842 | fix(gateway-cli): use wss:// scheme when gatewayTls is enabled
11986 | fix: drop empty assistant content blocks from error/aborted API responses
24635 | fix: recognize Bedrock as Anthropic-compatible in transcript policy
17950 | fix: filter error payloads from user-facing messages
22741 | fix(models): add DashScope/Qwen to normalizeModelCompat developer role guard
21820 | fix(exec): show requested host in disallowed host hint
# git apply --exclude changelog+tests (5):
23184 | fix(auto-reply): prevent reminder guard note leaking into channel messages
19996 | fix(plugins): bind logger methods to preserve this context
24737 | fix(telegram): record sent messages for reaction own mode filtering
24266 | fix(doctor): replace nonexistent auth add command with openclaw onboard
11160 | fix: add missing audio MIME-to-extension mappings (aac, flac, opus, wav)
